<!-- Gallery Catalog Container with Spectacular Effects -->
<div class="relative w-full min-h-screen">
  <!-- Main Content Container -->
  <div
    class="relative z-20 w-full max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 pt-2 pb-8"
  >
    <!-- Background Effects Container -->
    <div
      class="effects-container fixed inset-0 overflow-hidden pointer-events-none -z-10"
    >
      <!-- Ultra-Advanced Particle System -->
      <canvas #particleCanvas class="particle-canvas"></canvas>

      <!-- Orbes Grandes Morfol√≥gicos -->
      <div class="large-orbs">
        <div
          class="large-orb"
          style="left: -10%; top: 10%; animation-delay: 0s"
        ></div>
        <div
          class="large-orb"
          style="left: 80%; top: 60%; animation-delay: 3s"
        ></div>
        <div
          class="large-orb"
          style="left: 15%; top: 80%; animation-delay: 6s"
        ></div>
        <div
          class="large-orb"
          style="left: 70%; top: 20%; animation-delay: 9s"
        ></div>
        <div
          class="large-orb"
          style="left: 40%; top: 5%; animation-delay: 12s"
        ></div>
      </div>

      <!-- Orbes Medianos Flotantes -->
      <div class="medium-orbs">
        <div
          class="medium-orb"
          style="left: 10%; top: 30%; animation-delay: 1s"
        ></div>
        <div
          class="medium-orb"
          style="left: 85%; top: 15%; animation-delay: 4s"
        ></div>
        <div
          class="medium-orb"
          style="left: 50%; top: 70%; animation-delay: 7s"
        ></div>
        <div
          class="medium-orb"
          style="left: 25%; top: 50%; animation-delay: 2s"
        ></div>
        <div
          class="medium-orb"
          style="left: 75%; top: 85%; animation-delay: 5s"
        ></div>
        <div
          class="medium-orb"
          style="left: 5%; top: 75%; animation-delay: 8s"
        ></div>
        <div
          class="medium-orb"
          style="left: 90%; top: 40%; animation-delay: 3s"
        ></div>
      </div>

      <!-- Orbes Peque√±os Din√°micos -->
      <div class="small-orbs">
        <div
          class="small-orb"
          style="left: 5%; top: 15%; animation-delay: 0.5s"
        ></div>
        <div
          class="small-orb"
          style="left: 35%; top: 25%; animation-delay: 2.5s"
        ></div>
        <div
          class="small-orb"
          style="left: 55%; top: 10%; animation-delay: 4.5s"
        ></div>
        <div
          class="small-orb"
          style="left: 80%; top: 45%; animation-delay: 6.5s"
        ></div>
        <div
          class="small-orb"
          style="left: 95%; top: 25%; animation-delay: 1.5s"
        ></div>
        <div
          class="small-orb"
          style="left: 15%; top: 60%; animation-delay: 5.5s"
        ></div>
        <div
          class="small-orb"
          style="left: 45%; top: 80%; animation-delay: 3.5s"
        ></div>
        <div
          class="small-orb"
          style="left: 75%; top: 70%; animation-delay: 7.5s"
        ></div>
        <div
          class="small-orb"
          style="left: 25%; top: 90%; animation-delay: 1s"
        ></div>
        <div
          class="small-orb"
          style="left: 65%; top: 5%; animation-delay: 8s"
        ></div>
      </div>

      <!-- Formas Geom√©tricas Morfol√≥gicas -->
      <div class="morphing-shapes">
        <div
          class="morphing-shape triangle"
          style="left: 12%; top: 60%; animation-delay: 1s"
        ></div>
        <div
          class="morphing-shape hexagon"
          style="left: 88%; top: 40%; animation-delay: 3s"
        ></div>
        <div
          class="morphing-shape pentagon"
          style="left: 35%; top: 15%; animation-delay: 5s"
        ></div>
        <div
          class="morphing-shape octagon"
          style="left: 55%; top: 80%; animation-delay: 2s"
        ></div>
      </div>
    </div>

    <!-- Main Content Container -->
    <div
      class="relative z-20 w-full max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 pt-2 pb-8"
    >
      <!-- Header Section - Centered and Enhanced -->
      <div
        class="text-center mb-8"
        data-aos="fade-down"
        data-aos-duration="800"
      >
        <h1
          class="holographic-title text-4xl md:text-5xl lg:text-6xl font-bold mb-6 leading-tight"
        >
          <span class="title-word" data-text="Cat√°logo">Cat√°logo </span>
          <span class="title-word" data-text="de">de </span>
          <span class="title-word" data-text="Proyectos">Proyectos</span>
        </h1>
        <p
          class="text-lg md:text-xl text-gray-600 dark:text-gray-300 max-w-3xl mx-auto mb-8 leading-relaxed"
          data-aos="fade-up"
          data-aos-delay="300"
        >
          Explora nuestra colecci√≥n de proyectos innovadores y creativos
          desarrollados con las √∫ltimas tecnolog√≠as.
        </p>

        <!-- Search and Filter Bar with Holographic Effects -->
        <div
          class="search-container holographic-container flex flex-col lg:flex-row gap-4 items-start lg:items-center justify-between p-4 magnetic-element"
          data-aos="fade-up"
          data-aos-delay="200"
        >
          <!-- Search Bar -->
          <div class="relative flex-1 max-w-md">
            <div
              class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"
            >
              <span class="text-gray-400 text-xl">üîç</span>
            </div>
            <input
              type="text"
              [ngModel]="searchTerm()"
              (ngModelChange)="onSearchChange($event)"
              placeholder="Buscar proyectos, tecnolog√≠as..."
              class="holographic-input w-full pl-10 pr-4 py-3 border border-transparent rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 backdrop-blur-lg transition-all duration-300"
            />

            <!-- Clear search button -->
            <button
              *ngIf="searchTerm()"
              (click)="onSearchChange('')"
              class="absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-gray-600 dark:hover:text-gray-300"
            >
              ‚úï
            </button>
          </div>

          <!-- Filter Controls -->
          <div class="flex items-center gap-3">
            <!-- Favorites Counter -->
            <div
              *ngIf="getFavoritesCount() > 0"
              class="favorites-counter magnetic-element"
              data-aos="fade-in"
              data-aos-delay="400"
            >
              <span class="text-lg">‚ù§Ô∏è</span>
              <span>Favoritos</span>
              <span class="count">{{ getFavoritesCount() }}</span>
            </div>

            <!-- Results Count -->
            <span
              class="text-sm text-gray-600 dark:text-gray-400 whitespace-nowrap"
            >
              {{ getResultsText() }}
            </span>

            <!-- View Mode Toggle -->
            <div
              class="flex items-center bg-gray-100 dark:bg-gray-800 rounded-lg p-1 gap-1"
            >
              <button
                (click)="setViewMode('grid')"
                class="view-toggle-btn"
                [class.active]="isGridView()"
                [class.inactive]="!isGridView()"
                aria-label="Vista de cuadr√≠cula"
              >
                <span class="text-lg">‚äû</span>
              </button>
              <button
                (click)="setViewMode('list')"
                class="view-toggle-btn"
                [class.active]="isListView()"
                [class.inactive]="!isListView()"
                aria-label="Vista de lista"
              >
                <span class="text-lg">‚â°</span>
              </button>
            </div>

            <!-- Theme Toggle -->
            <app-theme-toggle
              variant="compact"
              [showLabel]="false"
              [showTooltip]="true"
              data-aos="fade-in"
              data-aos-delay="500"
            ></app-theme-toggle>

            <!-- Stats Toggle -->
            <button
              (click)="toggleStats()"
              class="flex items-center gap-2 px-3 py-2 rounded-lg text-sm font-medium transition-all duration-300"
              [class]="
                showStats()
                  ? 'bg-purple-100 dark:bg-purple-900 text-purple-800 dark:text-purple-300 border border-purple-200 dark:border-purple-800'
                  : 'bg-gray-100 dark:bg-gray-800 text-gray-600 dark:text-gray-400 border border-gray-200 dark:border-gray-700 hover:bg-gray-200 dark:hover:bg-gray-700'
              "
              data-aos="fade-in"
              data-aos-delay="550"
            >
              <span>üìä</span>
              Stats
            </button>

            <!-- Featured Only Toggle -->
            <button
              (click)="onFeaturedToggle()"
              class="flex items-center gap-2 px-3 py-2 rounded-lg text-sm font-medium transition-colors"
              [class]="
                showFeaturedOnly()
                  ? 'bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-300 border border-yellow-200 dark:border-yellow-800'
                  : 'bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-300 border border-gray-300 dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-600'
              "
            >
              <span>‚≠ê</span>
              Destacados
            </button>

            <!-- Filters Toggle -->
            <button
              (click)="toggleFilters()"
              class="flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg text-sm font-medium transition-colors"
            >
              <span>üéõÔ∏è</span>
              Filtros
              <span
                *ngIf="activeFiltersCount() > 0"
                class="bg-blue-800 text-white text-xs px-2 py-1 rounded-full"
              >
                {{ activeFiltersCount() }}
              </span>
            </button>
          </div>
        </div>
      </div>

      <!-- Advanced Filters Panel -->
      <div
        *ngIf="showFilters()"
        class="filter-panel mb-8 p-6 magnetic-element"
        data-aos="fade-down"
        data-aos-duration="500"
        data-aos-easing="ease-out-cubic"
      >
        <!-- Filter Header -->
        <div class="flex items-center justify-between mb-6">
          <h3 class="text-lg font-semibold text-gray-900 dark:text-white">
            Filtros Avanzados
          </h3>
          <div class="flex items-center gap-2">
            <button
              *ngIf="activeFiltersCount() > 0"
              (click)="clearFilters()"
              class="text-sm text-red-600 hover:text-red-800 dark:text-red-400 dark:hover:text-red-300 font-medium"
            >
              Limpiar Filtros
            </button>
            <button
              (click)="toggleFilters()"
              class="text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 text-xl"
            >
              ‚úï
            </button>
          </div>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
          <!-- Categories Filter -->
          <div>
            <h4 class="text-sm font-medium text-gray-900 dark:text-white mb-3">
              Categor√≠as
            </h4>
            <div class="space-y-2">
              <label class="flex items-center cursor-pointer">
                <input
                  type="radio"
                  name="category"
                  [checked]="!selectedCategory()"
                  (change)="onCategorySelect(null)"
                  class="mr-3 text-blue-600 focus:ring-blue-500"
                />
                <span class="text-sm text-gray-700 dark:text-gray-300"
                  >Todas las categor√≠as</span
                >
              </label>

              <label
                *ngFor="let category of categories()"
                class="flex items-center cursor-pointer"
              >
                <input
                  type="radio"
                  name="category"
                  [checked]="selectedCategory() === category.category"
                  (change)="onCategorySelect(category.category)"
                  class="mr-3 text-blue-600 focus:ring-blue-500"
                />
                <span
                  class="flex items-center text-sm text-gray-700 dark:text-gray-300"
                >
                  <span class="mr-2">{{ category.icon }}</span>
                  {{ category.label }}
                </span>
              </label>
            </div>
          </div>

          <!-- Technologies Filter -->
          <div>
            <h4 class="text-sm font-medium text-gray-900 dark:text-white mb-3">
              Tecnolog√≠as Populares
            </h4>
            <div class="space-y-2 max-h-48 overflow-y-auto">
              <label
                *ngFor="let tech of popularTechnologies()"
                class="flex items-center cursor-pointer"
              >
                <input
                  type="checkbox"
                  [checked]="isTechnologySelected(tech.name)"
                  (change)="onTechnologyToggle(tech.name)"
                  class="mr-3 text-blue-600 focus:ring-blue-500 rounded"
                />
                <span
                  class="flex items-center text-sm text-gray-700 dark:text-gray-300"
                >
                  <span class="mr-2">{{ tech.icon }}</span>
                  <span [class]="tech.color">{{ tech.name }}</span>
                </span>
              </label>
            </div>
          </div>

          <!-- Sort Options -->
          <div>
            <h4 class="text-sm font-medium text-gray-900 dark:text-white mb-3">
              Ordenar Por
            </h4>
            <div class="space-y-2">
              <!-- Sort Field -->
              <select
                [ngModel]="sortOption().field"
                (ngModelChange)="onSortChange($event, sortOption().direction)"
                class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm"
              >
                <option value="createdAt">Fecha de creaci√≥n</option>
                <option value="title">Nombre</option>
                <option value="views">Popularidad (vistas)</option>
                <option value="likes">Likes</option>
              </select>

              <!-- Sort Direction -->
              <div class="flex gap-2">
                <button
                  (click)="onSortChange(sortOption().field, 'desc')"
                  class="flex-1 px-3 py-2 text-sm rounded-lg transition-colors"
                  [class]="
                    sortOption().direction === 'desc'
                      ? 'bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-300 border border-blue-200 dark:border-blue-800'
                      : 'bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 border border-gray-300 dark:border-gray-600 hover:bg-gray-200 dark:hover:bg-gray-600'
                  "
                >
                  ‚Üì Descendente
                </button>
                <button
                  (click)="onSortChange(sortOption().field, 'asc')"
                  class="flex-1 px-3 py-2 text-sm rounded-lg transition-colors"
                  [class]="
                    sortOption().direction === 'asc'
                      ? 'bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-300 border border-blue-200 dark:border-blue-800'
                      : 'bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 border border-gray-300 dark:border-gray-600 hover:bg-gray-200 dark:hover:bg-gray-600'
                  "
                >
                  ‚Üë Ascendente
                </button>
              </div>
            </div>
          </div>
        </div>

        <!-- Selected Filters Summary -->
        <div
          *ngIf="activeFiltersCount() > 0"
          class="mt-6 pt-4 border-t border-gray-200 dark:border-gray-700"
        >
          <div class="flex flex-wrap gap-2">
            <span
              *ngIf="searchTerm()"
              class="inline-flex items-center gap-1 px-3 py-1 bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-300 text-sm rounded-full"
            >
              üîç "{{ searchTerm() }}"
              <button
                (click)="onSearchChange('')"
                class="hover:text-blue-600 dark:hover:text-blue-400"
              >
                √ó
              </button>
            </span>

            <span
              *ngIf="selectedCategory()"
              class="inline-flex items-center gap-1 px-3 py-1 bg-purple-100 dark:bg-purple-900 text-purple-800 dark:text-purple-300 text-sm rounded-full"
            >
              üìÇ {{ getCategoryLabel(selectedCategory()!) }}
              <button
                (click)="onCategorySelect(null)"
                class="hover:text-purple-600 dark:hover:text-purple-400"
              >
                √ó
              </button>
            </span>

            <span
              *ngFor="let tech of selectedTechnologies()"
              class="inline-flex items-center gap-1 px-3 py-1 bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-300 text-sm rounded-full"
            >
              {{ getTechnologyIcon(tech) }} {{ tech }}
              <button
                (click)="onTechnologyToggle(tech)"
                class="hover:text-green-600 dark:hover:text-green-400"
              >
                √ó
              </button>
            </span>

            <span
              *ngIf="showFeaturedOnly()"
              class="inline-flex items-center gap-1 px-3 py-1 bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-300 text-sm rounded-full"
            >
              ‚≠ê Destacados
              <button
                (click)="onFeaturedToggle()"
                class="hover:text-yellow-600 dark:hover:text-yellow-400"
              >
                √ó
              </button>
            </span>
          </div>
        </div>
      </div>

      <!-- Advanced Statistics and Progress Indicators -->
      <div
        *ngIf="showStats()"
        class="stats-panel mb-8"
        data-aos="fade-down"
        data-aos-duration="500"
        data-aos-easing="ease-out-cubic"
      >
        <app-progress-indicators
          variant="detailed"
          [showTrends]="true"
          [animateOnLoad]="true"
          [refreshInterval]="60000"
        >
        </app-progress-indicators>
      </div>

      <!-- Spectacular Loading Skeleton -->
      <div *ngIf="loading()" [class]="gridClasses()">
        <div
          *ngFor="let item of [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12]"
          class="card-skeleton masonry-item break-inside-avoid mb-6"
          data-aos="fade-up"
          [attr.data-aos-delay]="(item - 1) * 50"
          data-aos-duration="600"
        >
          <!-- Image Skeleton -->
          <div class="skeleton w-full h-48 mb-4"></div>

          <!-- Title Skeleton -->
          <div class="skeleton w-3/4 h-5 mb-3"></div>

          <!-- Description Skeleton -->
          <div class="skeleton w-full h-4 mb-2"></div>
          <div class="skeleton w-2/3 h-4 mb-4"></div>

          <!-- Tags Skeleton -->
          <div class="flex gap-2 mb-4">
            <div class="skeleton w-16 h-6 rounded-full"></div>
            <div class="skeleton w-20 h-6 rounded-full"></div>
            <div class="skeleton w-14 h-6 rounded-full"></div>
          </div>

          <!-- Stats Skeleton -->
          <div class="flex justify-between">
            <div class="skeleton w-12 h-4"></div>
            <div class="skeleton w-16 h-4"></div>
          </div>
        </div>
      </div>

      <!-- Error State -->
      <div
        *ngIf="error()"
        class="bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-6 mb-8"
      >
        <div class="flex items-center">
          <div class="text-red-500 text-xl mr-3">‚ö†Ô∏è</div>
          <div>
            <h3 class="text-red-800 dark:text-red-300 font-medium">
              Error al cargar proyectos
            </h3>
            <p class="text-red-600 dark:text-red-400 text-sm mt-1">
              {{ error() }}
            </p>
          </div>
        </div>
      </div>

      <!-- Projects Grid/List -->
      <div
        *ngIf="!loading() && !error() && displayedProjects().length > 0"
        [class]="gridClasses()"
      >
        <!-- Grid View Card -->
        <div
          *ngFor="
            let project of displayedProjects();
            trackBy: trackByProjectId;
            let i = index
          "
          [ngClass]="
            viewMode() === 'grid'
              ? 'project-card masonry-item'
              : 'project-list-item'
          "
          class="cursor-pointer magnetic-element backdrop-blur-lg bg-white/10 dark:bg-white/5 border border-white/20 rounded-xl shadow-xl hover:shadow-2xl transition-all duration-300 break-inside-avoid mb-6"
          [class.featured]="project.featured"
          (click)="onProjectClick(project)"
          data-aos="fade-up"
          data-aos-duration="800"
          [attr.data-aos-delay]="i * 100 + 100"
          data-aos-anchor-placement="top-bottom"
        >
          <!-- Grid View Template -->
          <ng-container *ngIf="viewMode() === 'grid'">
            <!-- Spectacular Image Container -->
            <div class="project-image-container">
              <img
                [lazyLoad]="getPrimaryImage(project)"
                [alt]="project.title"
                class="project-image"
                [attr.data-src]="getPrimaryImage(project)"
                loading="lazy"
              />

              <!-- Enhanced Featured Badge -->
              <div
                *ngIf="project.featured"
                class="featured-badge absolute top-4 left-4 bg-gradient-to-r from-yellow-400 via-yellow-500 to-orange-500 text-white text-xs font-bold px-3 py-1 rounded-full shadow-xl border border-yellow-300/30 z-10"
              >
                ‚≠ê Destacado
              </div>

              <!-- Enhanced Category Badge -->
              <div
                *ngIf="getCategoryInfo(project) as categoryInfo"
                class="category-badge absolute top-4 right-4 text-white text-xs font-semibold px-3 py-1 rounded-full shadow-xl border border-white/20 z-10"
                [class]="categoryInfo.color"
              >
                {{ categoryInfo.icon }} {{ categoryInfo.label }}
              </div>

              <!-- Favorites button temporarily disabled due to parsing issues -->

              <!-- Spectacular Overlay with Multiple Actions -->
              <div class="project-overlay">
                <button class="project-button">
                  <span class="mr-2">üëÅÔ∏è</span> Ver Proyecto
                </button>
                <button class="project-button secondary">
                  <span class="mr-2">üîó</span> Demo Live
                </button>
              </div>
            </div>

            <!-- Content Container -->
            <div class="p-6">
              <!-- Project Title -->
              <h3
                class="text-xl font-semibold text-white dark:text-gray-100 mb-2 line-clamp-1 group-hover:text-blue-300 dark:group-hover:text-blue-400 transition-colors drop-shadow-md"
              >
                {{ project.title }}
              </h3>

              <!-- Short Description -->
              <p
                class="text-gray-100 dark:text-gray-200 text-sm mb-4 line-clamp-2 leading-relaxed drop-shadow-sm"
              >
                {{ project.shortDescription }}
              </p>

              <!-- Spectacular Technologies -->
              <div class="tech-badges-container flex flex-wrap gap-2 mb-4">
                <span
                  *ngFor="
                    let tech of project.technologies.slice(0, 3);
                    let i = index
                  "
                  class="tech-badge"
                  [class.frontend]="getTechnologyColor(tech).includes('blue')"
                  [class.backend]="getTechnologyColor(tech).includes('green')"
                  [class.database]="getTechnologyColor(tech).includes('purple')"
                  [class.mobile]="getTechnologyColor(tech).includes('pink')"
                  [style.animation-delay.ms]="i * 100"
                >
                  <span class="mr-1">{{ getTechnologyIcon(tech) }}</span>
                  {{ tech }}
                </span>
                <span
                  *ngIf="project.technologies.length > 3"
                  class="inline-flex items-center px-2 py-1 rounded-md text-xs font-medium bg-gray-200 dark:bg-gray-600 text-gray-600 dark:text-gray-400"
                >
                  +{{ project.technologies.length - 3 }} m√°s
                </span>
              </div>

              <!-- Stats Row -->
              <div
                class="flex items-center justify-between text-sm text-gray-200 dark:text-gray-300 mb-3"
              >
                <div class="flex items-center space-x-4">
                  <span class="flex items-center">
                    <span class="mr-1">üëÄ</span>
                    {{ formatViews(project.stats.views) }}
                  </span>
                  <span class="flex items-center">
                    <span class="mr-1">‚ù§Ô∏è</span>
                    {{ project.stats.likes }}
                  </span>
                  <span class="flex items-center">
                    <span class="mr-1">üì§</span>
                    {{ project.stats.shares }}
                  </span>
                </div>
                <div class="flex items-center">
                  <span
                    class="text-xs bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-300 px-2 py-1 rounded-full"
                  >
                    {{ getProjectGrade(getProjectScore(project)) }}
                  </span>
                </div>
              </div>

              <!-- Footer -->
              <div
                class="flex items-center justify-between pt-3 border-t border-gray-200/30 dark:border-gray-600"
              >
                <span
                  class="text-xs text-gray-200 dark:text-gray-300 drop-shadow-sm"
                >
                  {{ getTimeSince(project.createdAt) }}
                </span>

                <div class="flex items-center space-x-2">
                  <!-- Demo Link -->
                  <a
                    *ngIf="project.demoUrl"
                    [href]="project.demoUrl"
                    target="_blank"
                    rel="noopener noreferrer"
                    class="text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300 transition-colors"
                    (click)="$event.stopPropagation()"
                  >
                    <span class="text-sm">üîó</span>
                  </a>

                  <!-- Repo Link -->
                  <a
                    *ngIf="project.repoUrl"
                    [href]="project.repoUrl"
                    target="_blank"
                    rel="noopener noreferrer"
                    class="text-gray-600 hover:text-gray-800 dark:text-gray-400 dark:hover:text-gray-300 transition-colors"
                    (click)="$event.stopPropagation()"
                  >
                    <span class="text-sm">üìÇ</span>
                  </a>
                </div>
              </div>
            </div>
          </ng-container>

          <!-- List View Template -->
          <ng-container *ngIf="viewMode() === 'list'">
            <div
              class="flex items-center gap-6 p-4 bg-white/10 dark:bg-black/20 backdrop-blur-xl border border-white/20 dark:border-white/10 rounded-xl shadow-lg hover:shadow-xl transition-all duration-300"
            >
              <!-- Image -->
              <div
                class="flex-shrink-0 w-32 h-24 rounded-lg overflow-hidden border-2 border-white/20"
              >
                <img
                  [lazyLoad]="getPrimaryImage(project)"
                  [alt]="project.title"
                  class="w-full h-full object-cover hover:scale-110 transition-transform duration-300"
                  [attr.data-src]="getPrimaryImage(project)"
                  loading="lazy"
                />
              </div>

              <!-- Content -->
              <div class="flex-1 min-w-0">
                <div class="flex items-start justify-between mb-2">
                  <h3
                    class="text-lg font-semibold text-gray-800 dark:text-white line-clamp-1 group-hover:text-blue-600 dark:group-hover:text-blue-400 transition-colors"
                  >
                    {{ project.title }}
                  </h3>

                  <!-- Badges -->
                  <div class="flex items-center gap-2 ml-4">
                    <span
                      *ngIf="project.featured"
                      class="px-2 py-1 bg-yellow-500/20 text-yellow-400 text-xs rounded-full border border-yellow-400/30"
                    >
                      ‚≠ê Destacado
                    </span>
                    <!-- Favorites button temporarily disabled -->
                  </div>
                </div>

                <p
                  class="text-gray-200 dark:text-gray-100 text-sm mb-3 line-clamp-2"
                >
                  {{ project.shortDescription }}
                </p>

                <!-- Technologies and Stats -->
                <div class="flex items-center justify-between">
                  <div class="flex flex-wrap gap-2">
                    <span
                      *ngFor="let tech of project.technologies.slice(0, 4)"
                      class="inline-block px-2 py-1 text-xs bg-gray-200/80 dark:bg-white/10 rounded-full text-gray-700 dark:text-white/80 border border-gray-300/50 dark:border-white/10"
                    >
                      {{ getTechnologyIcon(tech) }} {{ tech }}
                    </span>
                  </div>

                  <div
                    class="flex items-center gap-4 text-xs text-gray-300 dark:text-gray-200"
                  >
                    <span class="flex items-center gap-1">
                      <span>üëÅÔ∏è</span>
                      {{ formatViews(project.stats.views) }}
                    </span>
                    <span class="flex items-center gap-1">
                      <span>üìÖ</span>
                      {{ getTimeSince(project.createdAt) }}
                    </span>
                    <span class="flex items-center gap-1">
                      <span>‚≠ê</span>
                      {{ getProjectGrade(getProjectScore(project)) }}
                    </span>
                  </div>
                </div>
              </div>
            </div>
          </ng-container>
        </div>
      </div>

      <!-- Empty State -->
      <div
        *ngIf="!loading() && !error() && filteredProjects().length === 0"
        class="text-center py-12"
      >
        <div class="text-6xl mb-4">üîç</div>
        <h3 class="text-xl font-medium text-gray-900 dark:text-white mb-2">
          No se encontraron proyectos
        </h3>
        <p class="text-gray-600 dark:text-gray-400 mb-4">
          Intenta cambiar los filtros de b√∫squeda o explorar diferentes
          categor√≠as.
        </p>
        <button
          *ngIf="activeFiltersCount() > 0"
          (click)="clearFilters()"
          class="bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-6 rounded-lg transition-colors"
        >
          Limpiar Filtros
        </button>
      </div>

      <!-- Pagination -->
      <div
        *ngIf="
          !config.enableInfiniteScroll &&
          filteredProjects().length > config.itemsPerPage &&
          !loading() &&
          !error()
        "
        class="flex items-center justify-center mt-12 space-x-2"
      >
        <!-- Previous Button -->
        <button
          (click)="prevPage()"
          [disabled]="!hasPrevPage()"
          class="flex items-center px-4 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-lg hover:bg-gray-100 hover:text-gray-700 disabled:opacity-50 disabled:cursor-not-allowed dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white"
        >
          <span class="mr-1">‚Üê</span>
          Anterior
        </button>

        <!-- Page Numbers -->
        <div class="flex space-x-1">
          <ng-container
            *ngFor="let page of [].constructor(totalPages()); let i = index"
          >
            <button
              *ngIf="
                i + 1 === 1 ||
                i + 1 === totalPages() ||
                Math.abs(i + 1 - currentPage()) <= 2
              "
              (click)="goToPage(i + 1)"
              class="px-3 py-2 text-sm font-medium rounded-lg transition-colors"
              [class]="
                currentPage() === i + 1
                  ? 'text-blue-600 bg-blue-50 border border-blue-300 dark:bg-blue-900 dark:text-blue-300 dark:border-blue-800'
                  : 'text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white'
              "
            >
              {{ i + 1 }}
            </button>

            <!-- Ellipsis -->
            <span
              *ngIf="
                (i + 1 === 2 && currentPage() > 4) ||
                (i + 1 === totalPages() - 1 && currentPage() < totalPages() - 3)
              "
              class="px-3 py-2 text-sm text-gray-400"
            >
              ...
            </span>
          </ng-container>
        </div>

        <!-- Next Button -->
        <button
          (click)="nextPage()"
          [disabled]="!hasNextPage()"
          class="flex items-center px-4 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-lg hover:bg-gray-100 hover:text-gray-700 disabled:opacity-50 disabled:cursor-not-allowed dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white"
        >
          Siguiente
          <span class="ml-1">‚Üí</span>
        </button>
      </div>

      <!-- Page Info -->
      <div
        *ngIf="
          !config.enableInfiniteScroll &&
          filteredProjects().length > 0 &&
          !loading()
        "
        class="text-center mt-4 text-sm text-gray-600 dark:text-gray-400"
      >
        {{ getResultsText() }}
      </div>

      <!-- Spectacular Project Modal -->
      <app-project-modal
        [project]="selectedProject()"
        [allProjects]="allProjects()"
        [isOpen]="isModalOpen()"
        (closeModal)="closeModal()"
        (navigateToProject)="navigateToProject($event)"
      ></app-project-modal>
    </div>
  </div>
</div>
